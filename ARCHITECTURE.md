# Architecture & Flow Diagrams

## ğŸ—ï¸ System Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         CLIENT LAYER                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚  â”‚   Browser 1      â”‚         â”‚   Browser 2      â”‚            â”‚
â”‚  â”‚  (Host/User A)   â”‚         â”‚   (User B)       â”‚            â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤         â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤            â”‚
â”‚  â”‚  Angular App     â”‚         â”‚  Angular App     â”‚            â”‚
â”‚  â”‚  - HomeComponent â”‚         â”‚  - HomeComponent â”‚            â”‚
â”‚  â”‚  - RoomComponent â”‚         â”‚  - RoomComponent â”‚            â”‚
â”‚  â”‚  - SocketService â”‚         â”‚  - SocketService â”‚            â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚           â”‚                             â”‚                      â”‚
â”‚           â”‚ WebSocket (Socket.io-client)â”‚                      â”‚
â”‚           â”‚                             â”‚                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚                             â”‚
            â”‚         HTTP:4200           â”‚
            â”‚                             â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           â”‚                             â”‚                      â”‚
â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      â”‚
â”‚                         â”‚                                      â”‚
â”‚                    â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”                                â”‚
â”‚                    â”‚  CORS    â”‚                                â”‚
â”‚                    â”‚  Layer   â”‚                                â”‚
â”‚                    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                                â”‚
â”‚                         â”‚                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚       SERVER LAYER      â”‚                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                         â”‚                                      â”‚
â”‚                    â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”                                â”‚
â”‚                    â”‚ Express  â”‚                                â”‚
â”‚                    â”‚  Server  â”‚                                â”‚
â”‚                    â”‚  :3000   â”‚                                â”‚
â”‚                    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                                â”‚
â”‚                         â”‚                                      â”‚
â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                           â”‚
â”‚              â”‚                     â”‚                           â”‚
â”‚         â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”                     â”‚
â”‚         â”‚Socket.ioâ”‚         â”‚  REST API â”‚                     â”‚
â”‚         â”‚ Server  â”‚         â”‚ /api/roomsâ”‚                     â”‚
â”‚         â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚
â”‚              â”‚                                                 â”‚
â”‚         â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                      â”‚
â”‚         â”‚  Room Manager â”‚                                      â”‚
â”‚         â”‚               â”‚                                      â”‚
â”‚         â”‚ - rooms Map   â”‚                                      â”‚
â”‚         â”‚ - generateCodeâ”‚                                      â”‚
â”‚         â”‚ - syncState   â”‚                                      â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                      â”‚
â”‚                                                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”„ Data Flow Diagrams

### Flow 1: Create Room

```
User A Browser                Socket.io Server              Room Manager
     â”‚                              â”‚                           â”‚
     â”‚  1. Click "Create Room"      â”‚                           â”‚
     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶                           â”‚
     â”‚  emit('create-room')         â”‚                           â”‚
     â”‚  username: "Alice"           â”‚                           â”‚
     â”‚                              â”‚  2. Generate room code    â”‚
     â”‚                              â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚
     â”‚                              â”‚  generateRoomCode()       â”‚
     â”‚                              â”‚                           â”‚
     â”‚                              â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
     â”‚                              â”‚  roomCode: "ABC123"       â”‚
     â”‚                              â”‚                           â”‚
     â”‚                              â”‚  3. Create room object    â”‚
     â”‚                              â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚
     â”‚                              â”‚  rooms.set(code, room)    â”‚
     â”‚                              â”‚                           â”‚
     â”‚  4. Room created response    â”‚                           â”‚
     â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                           â”‚
     â”‚  on('room-created')          â”‚                           â”‚
     â”‚  { roomCode, room }          â”‚                           â”‚
     â”‚                              â”‚                           â”‚
     â”‚  5. Navigate to room         â”‚                           â”‚
     â”‚  /room/ABC123                â”‚                           â”‚
     â”‚                              â”‚                           â”‚
```

### Flow 2: Join Room

```
User B Browser           Socket.io Server           Room Manager           User A Browser
     â”‚                        â”‚                         â”‚                       â”‚
     â”‚  1. Enter code         â”‚                         â”‚                       â”‚
     â”‚  "ABC123"              â”‚                         â”‚                       â”‚
     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶                         â”‚                       â”‚
     â”‚  emit('join-room')     â”‚                         â”‚                       â”‚
     â”‚  { roomCode, username }â”‚                         â”‚                       â”‚
     â”‚                        â”‚  2. Find room           â”‚                       â”‚
     â”‚                        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶                       â”‚
     â”‚                        â”‚  rooms.get("ABC123")    â”‚                       â”‚
     â”‚                        â”‚                         â”‚                       â”‚
     â”‚                        â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                       â”‚
     â”‚                        â”‚  room object            â”‚                       â”‚
     â”‚                        â”‚                         â”‚                       â”‚
     â”‚                        â”‚  3. Add participant     â”‚                       â”‚
     â”‚                        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶                       â”‚
     â”‚                        â”‚  room.participants.push â”‚                       â”‚
     â”‚                        â”‚                         â”‚                       â”‚
     â”‚  4. Room joined        â”‚                         â”‚                       â”‚
     â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                         â”‚                       â”‚
     â”‚  on('room-joined')     â”‚                         â”‚                       â”‚
     â”‚  { room }              â”‚                         â”‚                       â”‚
     â”‚                        â”‚                         â”‚                       â”‚
     â”‚                        â”‚  5. Notify all users    â”‚                       â”‚
     â”‚                        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶
     â”‚                        â”‚  emit('participant-     â”‚  on('participant-     â”‚
     â”‚                        â”‚  joined')               â”‚  joined')             â”‚
     â”‚                        â”‚                         â”‚                       â”‚
```

### Flow 3: Video Synchronization

```
User A (Host)          Socket.io Server         User B             User C
     â”‚                       â”‚                     â”‚                 â”‚
     â”‚  1. Press Play        â”‚                     â”‚                 â”‚
     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶                     â”‚                 â”‚
     â”‚  emit('play-video')   â”‚                     â”‚                 â”‚
     â”‚  { roomCode, time }   â”‚                     â”‚                 â”‚
     â”‚                       â”‚                     â”‚                 â”‚
     â”‚                       â”‚  2. Update state    â”‚                 â”‚
     â”‚                       â”‚  room.videoState    â”‚                 â”‚
     â”‚                       â”‚  .isPlaying = true  â”‚                 â”‚
     â”‚                       â”‚                     â”‚                 â”‚
     â”‚                       â”‚  3. Broadcast       â”‚                 â”‚
     â”‚                       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶                 â”‚
     â”‚                       â”‚  emit('video-play') â”‚                 â”‚
     â”‚                       â”‚  to others only     â”‚                 â”‚
     â”‚                       â”‚                     â”‚                 â”‚
     â”‚                       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶
     â”‚                       â”‚  emit('video-play')                   â”‚
     â”‚                       â”‚                                       â”‚
     â”‚                       â”‚  4. Sync playback   â”‚                 â”‚
     â”‚                       â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                 â”‚
     â”‚                       â”‚  video.play()       â”‚                 â”‚
     â”‚                       â”‚                     â”‚                 â”‚
     â”‚                       â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
     â”‚                       â”‚                     â”‚  video.play()   â”‚
     â”‚                       â”‚                     â”‚                 â”‚
```

---

## ğŸ—‚ï¸ Component Hierarchy

```
App (Router Outlet)
â”‚
â”œâ”€â”€ HomeComponent
â”‚   â”œâ”€â”€ Username Input
â”‚   â”œâ”€â”€ Create Room Button
â”‚   â”œâ”€â”€ Join Room Button
â”‚   â””â”€â”€ Join Modal
â”‚       â”œâ”€â”€ Room Code Input
â”‚       â”œâ”€â”€ Cancel Button
â”‚       â””â”€â”€ Join Button
â”‚
â””â”€â”€ RoomComponent
    â”œâ”€â”€ Header
    â”‚   â”œâ”€â”€ Room Code Display
    â”‚   â”œâ”€â”€ Copy Button
    â”‚   â””â”€â”€ Exit Button
    â”‚
    â”œâ”€â”€ Video Section
    â”‚   â”œâ”€â”€ Video Player
    â”‚   â”‚   â””â”€â”€ HTML5 Video Element
    â”‚   â”‚
    â”‚   â””â”€â”€ Video Source Section
    â”‚       â”œâ”€â”€ Current URL Display
    â”‚       â”œâ”€â”€ Change Video Button
    â”‚       â””â”€â”€ URL Input Form
    â”‚
    â””â”€â”€ Participants Section
        â”œâ”€â”€ Section Header
        â””â”€â”€ Participant List
            â””â”€â”€ Participant Items
                â”œâ”€â”€ Username
                â””â”€â”€ Host Badge (conditional)
```

---

## ğŸ“¡ WebSocket Events Map

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    WEBSOCKET EVENTS                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  CLIENT â†’ SERVER                  SERVER â†’ CLIENT               â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•               â”‚
â”‚                                                                 â”‚
â”‚  create-room â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶ room-created                â”‚
â”‚   â””â”€ username                       â””â”€ { roomCode, room }       â”‚
â”‚                                                                 â”‚
â”‚  join-room â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶ room-joined                 â”‚
â”‚   â””â”€ { roomCode, username }         â””â”€ { room }                 â”‚
â”‚                                    â”‚                            â”‚
â”‚                                    â””â”€â–¶ participant-joined       â”‚
â”‚                                        â””â”€ { participant,        â”‚
â”‚                                            participants }        â”‚
â”‚                                                                 â”‚
â”‚  change-video â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶ video-changed              â”‚
â”‚   â””â”€ { roomCode, url }              â””â”€ { url }                  â”‚
â”‚                                                                 â”‚
â”‚  play-video â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶ video-play                 â”‚
â”‚   â””â”€ { roomCode, currentTime }      â””â”€ { currentTime }          â”‚
â”‚                                                                 â”‚
â”‚  pause-video â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶ video-pause                â”‚
â”‚   â””â”€ { roomCode, currentTime }      â””â”€ { currentTime }          â”‚
â”‚                                                                 â”‚
â”‚  seek-video â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶ video-seek                 â”‚
â”‚   â””â”€ { roomCode, currentTime }      â””â”€ { currentTime }          â”‚
â”‚                                                                 â”‚
â”‚  leave-room â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶ participant-left           â”‚
â”‚                                      â””â”€ { participantId,        â”‚
â”‚                                          participants }          â”‚
â”‚                                    â”‚                            â”‚
â”‚                                    â””â”€â–¶ host-changed             â”‚
â”‚                                        â””â”€ { newHostId }          â”‚
â”‚                                                                 â”‚
â”‚  disconnect â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶ [Room cleanup]             â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ” State Management

### Server State (In-Memory)

```javascript
rooms: Map<string, Room>
â”œâ”€ "ABC123": {
â”‚    code: "ABC123",
â”‚    host: "socketId1",
â”‚    participants: [
â”‚      { id: "socketId1", username: "Alice", isHost: true },
â”‚      { id: "socketId2", username: "Bob", isHost: false }
â”‚    ],
â”‚    videoState: {
â”‚      url: "https://video.mp4",
â”‚      currentTime: 45.5,
â”‚      isPlaying: true
â”‚    }
â”‚  }
â”‚
â”œâ”€ "XYZ789": { ... }
â””â”€ "DEF456": { ... }
```

### Client State (Component)

```typescript
// HomeComponent
username: string
roomCode: string
errorMessage: string
showJoinDialog: boolean

// RoomComponent
roomCode: string
room: Room | null
currentUser: Participant | null
videoUrl: string
newVideoUrl: string
isChangingVideo: boolean
isSyncing: boolean
```

---

## ğŸ”„ Lifecycle & Hooks

### Room Creation Lifecycle

```
1. User Input
   â””â”€ username (optional)

2. Click Create
   â””â”€ HomeComponent.createNewRoom()

3. Emit Event
   â””â”€ SocketService.createRoom(username)

4. Server Processing
   â”œâ”€ Generate room code
   â”œâ”€ Create room object
   â””â”€ Store in rooms Map

5. Response
   â””â”€ emit('room-created')

6. Client Handling
   â”œâ”€ Subscribe in HomeComponent
   â””â”€ Navigate to /room/:code

7. Room Component Init
   â”œâ”€ ngOnInit()
   â”œâ”€ Get room code from route
   â”œâ”€ Setup socket listeners
   â””â”€ Wait for room data
```

### Video Sync Lifecycle

```
1. User Action
   â””â”€ Play/Pause/Seek video

2. Event Capture
   â””â”€ (play), (pause), (seeked) on <video>

3. Component Handler
   â””â”€ onPlay() / onPause() / onSeeked()

4. Emit to Server
   â””â”€ SocketService.playVideo(roomCode, time)

5. Server Broadcast
   â””â”€ socket.to(roomCode).emit('video-play')

6. Other Clients Receive
   â””â”€ SocketService.onVideoPlay()

7. Update Video Element
   â””â”€ videoPlayer.nativeElement.play()

8. Sync Complete
   â””â”€ All users at same timestamp
```

---

## ğŸ¯ Error Handling Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Error Scenarios             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                     â”‚
â”‚  Room Not Found                     â”‚
â”‚  â”œâ”€ User enters invalid code        â”‚
â”‚  â”œâ”€ Server checks rooms.get(code)   â”‚
â”‚  â”œâ”€ Returns null                    â”‚
â”‚  â”œâ”€ emit('room-error')              â”‚
â”‚  â””â”€ Display error message           â”‚
â”‚                                     â”‚
â”‚  Connection Lost                    â”‚
â”‚  â”œâ”€ Network interruption            â”‚
â”‚  â”œâ”€ Socket disconnects              â”‚
â”‚  â”œâ”€ handleDisconnect()              â”‚
â”‚  â”œâ”€ Remove from participants        â”‚
â”‚  â””â”€ Notify remaining users          â”‚
â”‚                                     â”‚
â”‚  Video Load Failed                  â”‚
â”‚  â”œâ”€ Invalid URL or CORS issue       â”‚
â”‚  â”œâ”€ HTML5 video error event         â”‚
â”‚  â”œâ”€ Show placeholder                â”‚
â”‚  â””â”€ Allow retry                     â”‚
â”‚                                     â”‚
â”‚  Empty Room                         â”‚
â”‚  â”œâ”€ Last participant leaves         â”‚
â”‚  â”œâ”€ participants.length === 0       â”‚
â”‚  â”œâ”€ rooms.delete(roomCode)          â”‚
â”‚  â””â”€ Room no longer accessible       â”‚
â”‚                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ” Security Considerations

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      Security Layer (Future)           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                        â”‚
â”‚  Current Implementation:               â”‚
â”‚  âœ“ CORS configured                     â”‚
â”‚  âœ“ Input sanitization (Angular)       â”‚
â”‚  âœ“ Room code validation                â”‚
â”‚                                        â”‚
â”‚  Future Enhancements:                  â”‚
â”‚  â—‹ Rate limiting                       â”‚
â”‚  â—‹ Room passwords                      â”‚
â”‚  â—‹ User authentication                 â”‚
â”‚  â—‹ Video URL validation                â”‚
â”‚  â—‹ XSS prevention                      â”‚
â”‚  â—‹ DDoS protection                     â”‚
â”‚  â—‹ SSL/TLS encryption                  â”‚
â”‚                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“Š Scalability Architecture (Future)

```
Current: Single Server
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Clients    â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Node.js    â”‚
â”‚  Socket.io   â”‚
â”‚  (In-Memory) â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Future: Distributed System
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Clients            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
      â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”
      â”‚Load Balancerâ”‚
      â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
             â”‚
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚         â”‚         â”‚
â”Œâ”€â”€â–¼â”€â”€â”€â” â”Œâ”€â”€â–¼â”€â”€â”€â” â”Œâ”€â”€â–¼â”€â”€â”€â”
â”‚Node 1â”‚ â”‚Node 2â”‚ â”‚Node 3â”‚
â””â”€â”€â”¬â”€â”€â”€â”˜ â””â”€â”€â”¬â”€â”€â”€â”˜ â””â”€â”€â”¬â”€â”€â”€â”˜
   â”‚        â”‚        â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
     â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”
     â”‚    Redis    â”‚
     â”‚   (State)   â”‚
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

This architecture supports real-time synchronization for multiple users watching videos together!
