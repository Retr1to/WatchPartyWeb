<div class="room-container" *ngIf="room">
  <div class="room-header">
    <div class="room-info">
      <div class="room-code-display">
        <span class="room-icon"></span>
        <span class="room-code">{{ roomCode }}</span>
        <button class="copy-btn" (click)="copyRoomCode()" title="Copiar c贸digo">
          
        </button>
      </div>
    </div>
    <button class="exit-btn" (click)="leaveRoom()">
      Salir
    </button>
  </div>

  <div class="room-content">
    <div class="video-section">
      <div class="video-container">
        <ng-container [ngSwitch]="videoProvider">
          <ng-container *ngSwitchCase="'youtube'">
            <div class="youtube-wrapper" *ngIf="videoUrl">
              <div #youtubePlayerContainer class="youtube-player"></div>
            </div>
          </ng-container>
          <ng-container *ngSwitchDefault>
            <video 
              #videoPlayer
              *ngIf="videoUrl"
              [src]="videoUrl"
              (play)="onPlay()"
              (pause)="onPause()"
              (seeked)="onSeeked()"
              (timeupdate)="onTimeUpdate()"
              controls
              controlsList="nodownload"
              playsinline
            ></video>
          </ng-container>
        </ng-container>
        
        <div class="video-placeholder" *ngIf="!videoUrl">
          <svg width="100" height="100" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <rect x="2" y="6" width="20" height="12" rx="2" stroke="white" stroke-width="2" fill="none"/>
            <circle cx="17" cy="12" r="2" fill="white"/>
          </svg>
          <p>Video en reproducci贸n</p>
        </div>
      </div>

      <div class="video-source-section">
        <div class="section-header">
          <span class="section-icon"></span>
          <span>Fuente de Video</span>
        </div>
        
        <input 
          #fileInput 
          type="file" 
          accept="video/mp4,video/webm,video/ogg,video/mov"
          (change)="onFileSelected($event)"
          style="display: none"
        />
        
        <div class="video-url-display" *ngIf="!isChangingVideo">
          <div class="current-url" *ngIf="videoUrl">
            <span class="url-text">{{ videoUrl }}</span>
          </div>
          <div class="no-url" *ngIf="!videoUrl">
            <span>No hay video seleccionado</span>
          </div>
          
          <div class="video-buttons" *ngIf="isHost()">
            <button class="btn btn-upload" (click)="fileInput.click()">
               Subir Video
            </button>
            <button class="btn btn-change" (click)="showVideoInput()">
               Pegar URL
            </button>
          </div>
          
          <div class="no-host-message" *ngIf="!isHost()">
            <span>Solo el anfitri贸n puede cargar videos</span>
          </div>
        </div>

        <div class="video-url-input" *ngIf="isChangingVideo">
          <input 
            type="text" 
            [(ngModel)]="newVideoUrl" 
            placeholder="Ingresa la URL del video (YouTube o enlace directo)"
            (keyup.enter)="changeVideo()"
          />
          <div class="input-buttons">
            <button class="btn btn-secondary" (click)="cancelVideoChange()">
              Cancelar
            </button>
            <button class="btn btn-primary" (click)="changeVideo()">
              Cargar Video
            </button>
          </div>
        </div>
      </div>
    </div>

    <div class="participants-section">
      <div class="section-header">
        <span class="section-icon"></span>
        <span>Participantes ({{ room.participants.length }})</span>
      </div>
      
      <div class="participants-list">
        <div 
          *ngFor="let participant of room.participants" 
          class="participant"
          [class.host]="participant.isHost"
        >
          <div class="participant-info">
            <span class="participant-name">{{ participant.username }}</span>
            <span class="participant-badge" *ngIf="participant.isHost">
              Anfitri贸n
            </span>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<div class="loading" *ngIf="!room">
  <div class="spinner"></div>
  <p>Conectando a la sala...</p>
</div>
