<div class="room-container" *ngIf="room">
  <div class="room-header">
    <div class="room-info">
      <div class="room-code-display">
        <span class="room-icon">ðŸ“¹</span>
        <span class="room-code">{{ roomCode }}</span>
        <button class="copy-btn" (click)="copyRoomCode()" title="Copiar cÃ³digo">
          ðŸ“‹
        </button>
      </div>
    </div>
    <button class="exit-btn" (click)="leaveRoom()">
      Salir
    </button>
  </div>

  <div class="room-content">
    <div class="video-section">
      <div class="video-container">
        <video 
          #videoPlayer
          *ngIf="videoUrl"
          [src]="videoUrl"
          (play)="onPlay()"
          (pause)="onPause()"
          (seeked)="onSeeked()"
          controls
          controlsList="nodownload"
        ></video>
        
        <div class="video-placeholder" *ngIf="!videoUrl">
          <svg width="100" height="100" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <rect x="2" y="6" width="20" height="12" rx="2" stroke="white" stroke-width="2" fill="none"/>
            <circle cx="17" cy="12" r="2" fill="white"/>
          </svg>
          <p>Video en reproducciÃ³n</p>
        </div>
      </div>

      <div class="video-source-section">
        <div class="section-header">
          <span class="section-icon">ðŸŽ¬</span>
          <span>Fuente de Video</span>
        </div>
        
        <!-- âœ… INPUT OCULTO PARA SELECCIONAR ARCHIVO -->
        <input 
          #fileInput 
          type="file" 
          accept="video/mp4,video/webm,video/ogg,video/mov"
          (change)="onFileSelected($event)"
          style="display: none"
        />
        
        <div class="video-url-display" *ngIf="!isChangingVideo">
          <div class="current-url" *ngIf="videoUrl">
            <span class="url-text">{{ videoUrl }}</span>
          </div>
          <div class="no-url" *ngIf="!videoUrl">
            <span>No hay video seleccionado</span>
          </div>
          
          <!-- âœ… BOTONES: Solo visibles para el HOST -->
          <div class="video-buttons" *ngIf="isHost()">
            <button class="btn btn-upload" (click)="fileInput.click()">
              ðŸ“¤ Subir Video
            </button>
            <button class="btn btn-change" (click)="showVideoInput()">
              ðŸ”— Pegar URL
            </button>
          </div>
          
          <!-- Mensaje para invitados -->
          <div class="no-host-message" *ngIf="!isHost()">
            <span>Solo el anfitriÃ³n puede cargar videos</span>
          </div>
        </div>

        <!-- Input para URL -->
        <div class="video-url-input" *ngIf="isChangingVideo">
          <input 
            type="text" 
            [(ngModel)]="newVideoUrl" 
            placeholder="Ingresa la URL del video"
            (keyup.enter)="changeVideo()"
          />
          <div class="input-buttons">
            <button class="btn btn-secondary" (click)="cancelVideoChange()">
              Cancelar
            </button>
            <button class="btn btn-primary" (click)="changeVideo()">
              Cargar Video
            </button>
          </div>
        </div>
      </div>
    </div>

    <div class="participants-section">
      <div class="section-header">
        <span class="section-icon">ðŸ‘¥</span>
        <span>Participantes ({{ room.participants.length }})</span>
      </div>
      
      <div class="participants-list">
        <div 
          *ngFor="let participant of room.participants" 
          class="participant"
          [class.host]="participant.isHost"
        >
          <div class="participant-info">
            <span class="participant-name">{{ participant.username }}</span>
            <span class="participant-badge" *ngIf="participant.isHost">
              AnfitriÃ³n
            </span>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<div class="loading" *ngIf="!room">
  <div class="spinner"></div>
  <p>Conectando a la sala...</p>
</div>